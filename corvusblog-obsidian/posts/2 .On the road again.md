---
title: Tasky - here we go !
date: 2024-11-30
draft: false
tags:
  - tech
  - tasky
---

On y va on se lance pour de bon !

On se lance dans les details de la création de Tasky, que tu peut retrouver [ICI Tasky](https://tashikomaaa.github.io/corvusblog/posts/1-.ready-to-create-my-own-pm2-clone) 

---

On commence donc par créer le ficher qui va gérer les commandes reçu.

donc on créer le dossier du projet:

```console
mkdir tasky
cd tasky
```

on créer ensuite le dossier pour les scripts
```console
mkdir src
cd src
```

et finalement le fichier pour les commandes cli
```console
touch cli.js
```

Maintenant on va devoir ajouter quelque librairies pour pouvoir faire ce que l'on veut

on va avoir besoin de:
- [Commander](https://www.npmjs.com/package/commander) solution pour les script node en cli
- [chalk](https://www.npmjs.com/package/chalk) Pour mettre un peu de couleurs dans nos vies !
- [pidusage](https://www.npmjs.com/package/pidusage) Pour connaitre le pourcentage d'utilisation du cpu pour chaque process

---

on va donc installer tout ça !

---

on va initier le projet et installer les dependences:
```console
npm init
npm install commander chalk pidusage
```

--- 

On va enfin pouvoir commencer !

On va donc ouvrir le fichier `cli.js`, dans lequel on va ajouter la gestion des commandes lancer depuis le terminal.

`cli.js`
```javascript
#!/usr/bin/env node

import { Command } from 'commander'; // Import commander for the cli command gestion

import fs from 'fs'; // Import fs for files gestion

import chalk from 'chalk'; // Import chalk for colorization

const program = new Command(); // Initialization of a new Command instance

/**
code for the command we goind to details down there
**/ 

program.parse(process.argv); // Get all the arguments of the cli command
```


---

On va donc rajouter dans notre script la gestion des commandes, on commence par la command `start`

`cli.js`
```javascript
// Command to start a new process

program
	.command('start <name> <script>')
	.description('Start a new process')
	.action((name, script) => {
		console.log(chalk.cyan(`Starting process: ${name} with script ${script}`));
		try {
			startProcess(name, script);
		} catch (error) {
			console.error(chalk.red(`Error starting process: ${error.message}`));
		}
	});
```

Comme on peut le voir ici on ajoute en premier la commande:
	`.command('start <name> <script>')`
Qui avec la description:
	`.description('Start a new process')` 
Ajoute une ligne dans le manuel de notre script
