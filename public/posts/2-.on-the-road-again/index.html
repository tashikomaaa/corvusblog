<!doctype html><html lang=en><head><title>Tasky - here we go ! :: Corvus Blog</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="On y va on se lance pour de bon !
On se lance dans les details de la création de Tasky, que tu peut retrouver ICI Tasky
Initialization cli.js tasky start tasky stop On commence donc par créer le ficher qui va gérer les commandes reçu.
donc on créer le dossier du projet:
mkdir tasky cd tasky on créer ensuite le dossier pour les scripts
mkdir src cd src et finalement le fichier pour les commandes cli
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://tashikomaaa.github.io/corvusblog/posts/2-.on-the-road-again/><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/code.min.00125962708925857e7b66dbc58391d55be1191a3d0ce2034de8c9cd2c481c36.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/main.min.fe8dc560fccb53a458b0db19ccb7b265764ac46b68596b7e099c6793054dd457.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/menu.min.83637a90d903026bc280d3f82f96ceb06c5fc72b7c1a8d686afb5bbf818a29f7.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/post.min.fc74ca360273c1d828da3c02b8174eba435607b369d98418ccc6f2243cd4e75d.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/prism.min.9023bbc24533d09e97a51a0a42a5a7bfe4c591ae167c5551fb1d2191d11977c0.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/syntax.min.cc789ed9377260d7949ea4c18781fc58959a89287210fe4edbff44ebfc1511b6.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/terminal.min.dd0bf9c7cacb24c1b0184f52f1869b274e06689557468cc7030ccf632328eb97.css><link rel=stylesheet href=https://tashikomaaa.github.io/corvusblog/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel="shortcut icon" href=https://tashikomaaa.github.io/corvusblog/favicon.png><link rel=apple-touch-icon href=https://tashikomaaa.github.io/corvusblog/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Tasky - here we go !"><meta property="og:description" content="On y va on se lance pour de bon !
On se lance dans les details de la création de Tasky, que tu peut retrouver ICI Tasky
Initialization cli.js tasky start tasky stop On commence donc par créer le ficher qui va gérer les commandes reçu.
donc on créer le dossier du projet:
mkdir tasky cd tasky on créer ensuite le dossier pour les scripts
mkdir src cd src et finalement le fichier pour les commandes cli
"><meta property="og:url" content="https://tashikomaaa.github.io/corvusblog/posts/2-.on-the-road-again/"><meta property="og:site_name" content="Corvus Blog"><meta property="og:image" content="https://tashikomaaa.github.io/corvusblog/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2024-11-30 00:00:00 +0000 UTC"></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=https://tashikomaaa.github.io/corvusblog/><div class=logo>Covrus Blog</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/corvusblog/about>About</a></li><li><a href=/corvusblog/showcase>Showcase</a></li><hr><li><a href=https://tashikomaaa.github.io/corvusblog/>English</a></li></ul></li></ul><ul class="menu menu--desktop menu--language-selector"><li class=menu__trigger>English&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=https://tashikomaaa.github.io/corvusblog/>English</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><ul class=menu><li class=menu__trigger>Show more&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/corvusblog/about>About</a></li><li><a href=/corvusblog/showcase>Showcase</a></li></ul></li></ul></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://tashikomaaa.github.io/corvusblog/posts/2-.on-the-road-again/>Tasky - here we go !</a></h1><div class=post-meta><time class=post-date>2024-11-30&nbsp;[Updated: 2024-11-30]</time></div><span class=post-tags>#<a href=https://tashikomaaa.github.io/corvusblog/tags/tech/>tech</a>&nbsp;
#<a href=https://tashikomaaa.github.io/corvusblog/tags/tasky/>tasky</a>&nbsp;</span><div class=post-content><div><p>On y va on se lance pour de bon !</p><p>On se lance dans les details de la création de Tasky, que tu peut retrouver <a href=https://tashikomaaa.github.io/corvusblog/posts/1-.ready-to-create-my-own-pm2-clone>ICI Tasky</a></p><hr><ul><li><a href=#initialization-clijs title="Initialization cli.js">Initialization cli.js</a></li><li><a href=#tasky-start title="Tasky start">tasky start</a></li><li><a href=#tasky-stop title="Tasky stop">tasky stop</a></li></ul><hr><p>On commence donc par créer le ficher qui va gérer les commandes reçu.</p><p>donc on créer le dossier du projet:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mkdir tasky
</span></span><span style=display:flex><span>cd tasky
</span></span></code></pre></div><p>on créer ensuite le dossier pour les scripts</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mkdir src
</span></span><span style=display:flex><span>cd src
</span></span></code></pre></div><p>et finalement le fichier pour les commandes cli</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>touch cli.js
</span></span></code></pre></div><p>Maintenant on va devoir ajouter quelque librairies pour pouvoir faire ce que l&rsquo;on veut</p><p>on va avoir besoin de:</p><ul><li><a href=https://www.npmjs.com/package/commander>Commander</a> solution pour les script node en cli</li><li><a href=https://www.npmjs.com/package/chalk>chalk</a> Pour mettre un peu de couleurs dans nos vies !</li><li><a href=https://www.npmjs.com/package/pidusage>pidusage</a> Pour connaitre le pourcentage d&rsquo;utilisation du cpu pour chaque process</li></ul><hr><p>on va donc installer tout ça !</p><hr><p>on va initier le projet et installer les dependences:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>npm init
</span></span><span style=display:flex><span>npm install commander chalk pidusage
</span></span></code></pre></div><hr><h2 id=initialization-clijs>Initialization cli.js<a href=#initialization-clijs class=hanchor arialabel=Anchor>#</a></h2><p>On va enfin pouvoir commencer !</p><p>On va donc ouvrir le fichier <code>cli.js</code>, dans lequel on va ajouter la gestion des commandes lancer depuis le terminal.</p><p><code>cli.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env node
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Command</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;commander&#39;</span>; <span style=color:#75715e>// Import commander for the cli command gestion
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>fs</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;fs&#39;</span>; <span style=color:#75715e>// Import fs for files gestion
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>chalk</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;chalk&#39;</span>; <span style=color:#75715e>// Import chalk for colorization
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>program</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Command</span>(); <span style=color:#75715e>// Initialization of a new Command instance
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>code for the command we goind to details down there
</span></span></span><span style=display:flex><span><span style=color:#75715e>**/</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>program</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>argv</span>); <span style=color:#75715e>// Get all the arguments of the cli command
</span></span></span></code></pre></div><hr><h2 id=tasky-start>tasky start<a href=#tasky-start class=hanchor arialabel=Anchor>#</a></h2><p>On va donc rajouter dans notre script la gestion des commandes, on commence par la command</p><p><code>tasky start &lt;name> &lt;script></code></p><p><code>cli.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Command to start a new process
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>program</span>
</span></span><span style=display:flex><span>	.<span style=color:#a6e22e>command</span>(<span style=color:#e6db74>&#39;start &lt;name&gt; &lt;script&gt;&#39;</span>)
</span></span><span style=display:flex><span>	.<span style=color:#a6e22e>description</span>(<span style=color:#e6db74>&#39;Start a new process&#39;</span>)
</span></span><span style=display:flex><span>	.<span style=color:#a6e22e>action</span>((<span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>script</span>) =&gt; {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>chalk</span>.<span style=color:#a6e22e>cyan</span>(<span style=color:#e6db74>`Starting process: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74> with script </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>script</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>));
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>startProcess</span>(<span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>script</span>);
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>chalk</span>.<span style=color:#a6e22e>red</span>(<span style=color:#e6db74>`Error starting process: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>));
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	});
</span></span></code></pre></div><p>Comme on peut le voir ici on ajoute en premier la commande:
<code>.command('start &lt;name> &lt;script>')</code>
Qui avec la description:
<code>.description('Start a new process')</code>
Ajoute une ligne dans le manuel de notre script.
Elle prend donc comme arguments le nom du process et le script que l&rsquo;on va lancer.</p><hr><h2 id=tasky-stop>tasky stop<a href=#tasky-stop class=hanchor arialabel=Anchor>#</a></h2><p><code>tasky stop &lt;pid></code></p><p><code>cli.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// Command to stop a process by PID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>program</span>
</span></span><span style=display:flex><span>	.<span style=color:#a6e22e>command</span>(<span style=color:#e6db74>&#39;stop &lt;pid | name&gt;&#39;</span>)
</span></span><span style=display:flex><span>	.<span style=color:#a6e22e>description</span>(<span style=color:#e6db74>&#39;Stop a process by PID or name&#39;</span>)
</span></span><span style=display:flex><span>	.<span style=color:#a6e22e>action</span>((<span style=color:#a6e22e>pid</span>) =&gt; {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>chalk</span>.<span style=color:#a6e22e>yellow</span>(<span style=color:#e6db74>`Stopping process with PID: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pid</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>));
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>stopProcess</span>(Number(<span style=color:#a6e22e>pid</span>));
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>chalk</span>.<span style=color:#a6e22e>red</span>(<span style=color:#e6db74>`Error stopping process: </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>));
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	});
</span></span></code></pre></div><p>Comme on peut le voir ici on ajoute en premier la commande:
<code>.command('stop &lt;pid | name>')</code>
Qui avec la description:
<code>.description('Stop a process by PID or name')</code>
Ajoute une ligne dans le manuel de notre script.
Elle prend donc comme arguments le pid ou le nom du process a arreter</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><a href=https://tashikomaaa.github.io/corvusblog/posts/first-post/ class="button inline prev">corvusblog
</a>::
<a href=https://tashikomaaa.github.io/corvusblog/posts/1-.ready-to-create-my-own-pm2-clone/ class="button inline next">Tasky - what i want</a></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>Corvus Blog © 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/corvusblog/bundle.min.js></script></div></body></html>